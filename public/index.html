<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8'>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.5.1/dist/chart.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.js" integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk=" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link rel='stylesheet' href='/public/styles.css'>
    <title>JARS</title>
</head>
<body class="bg-blue-200">
<div class="relative min-h-screen flex">
<div class="bg-yellow-300 text-black w-64 space-x-2 px-2">
    <form action="/logout?_method=DELETE" method="POST">
  <div class="p-4">
      <a href="/home" title="JARSÂ²"><svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24"><path d="M8.5 2c.827 0 1.5.673 1.5 1.5v7.525c0 1.569.514 2.287 1.411 3.05 1.01.858 1.589 2.106 1.589 3.425 0 2.481-2.019 4.5-4.5 4.5s-4.5-2.019-4.5-4.5c0-1.319.579-2.567 1.59-3.425.896-.761 1.41-1.48 1.41-3.05v-7.525c0-.827.673-1.5 1.5-1.5zm0-2c-1.933 0-3.5 1.567-3.5 3.5v7.525c0 .587-.258 1.145-.705 1.525-1.403 1.192-2.295 2.965-2.295 4.95 0 3.59 2.909 6.5 6.5 6.5s6.5-2.91 6.5-6.5c0-1.985-.892-3.758-2.295-4.95-.447-.38-.705-.938-.705-1.525v-7.525c0-1.933-1.567-3.5-3.5-3.5zm2.107 14.718c-1.012-.89-1.607-1.734-1.607-3.22v-6.498h-1v6.498c0 1.484-.597 2.332-1.607 3.22-.794.698-1.393 1.642-1.393 2.782 0 1.933 1.567 3.5 3.5 3.5s3.5-1.567 3.5-3.5c0-1.14-.599-2.083-1.393-2.782zm11.393-8.718h-3v-3h-2v3h-3v2h3v3h2v-3h3v-2z"/></svg></a>
  </div>

        <nav class="py-8">
            <a href="/home" class="block py-2.5 px-4 transition duration-200 hover:bg-blue-200 rounded font-bold">Home</a>
            <a href="/settings" class="block py-2.5 px-4 transition duration-200 hover:bg-blue-200 rounded font-bold">Settings</a>

            <a href="/">
                <button type="submit">
                    <div class="flex flex-wrap content-evenly block py-2.5 px-4 transition duration-200 hover:bg-blue-200 rounded font-bold">
                        <div><svg xmlns="http://www.w3.org/2000/svg"  width="24" height="24" viewBox="0 0 24 24"><path d="M16 9v-4l8 7-8 7v-4h-8v-6h8zm-2 10v-.083c-1.178.685-2.542 1.083-4 1.083-4.411 0-8-3.589-8-8s3.589-8 8-8c1.458 0 2.822.398 4 1.083v-2.245c-1.226-.536-2.577-.838-4-.838-5.522 0-10 4.477-10 10s4.478 10 10 10c1.423 0 2.774-.302 4-.838v-2.162z"/></svg></div>
                        <div>&nbsp; Log out</div>
                    </div>
                </button>
            </a>

        </nav>

    </form>
</div>

    <div class="px-4 py-16 space-y-0.5">
        <div class="flex items-start">
            <div class="flex box rounded bg-white w-auto h-auto shadow items-center p-8">
                <div class="p-2">
                    <div class="quesData">
                        <svg style="fill: deepskyblue" width="24" height="24" viewBox="0 0 1000 1000" xmlns="http://www.w3.org/2000/svg"><path d="M 500 0C 224 0 0 224 0 500C 0 776 224 1000 500 1000C 776 1000 1000 776 1000 500C 1000 224 776 0 500 0C 500 0 500 0 500 0 M 501 191C 626 191 690 275 690 375C 690 475 639 483 595 513C 573 525 558 553 559 575C 559 591 554 602 541 601C 541 601 460 601 460 601C 446 601 436 581 436 570C 436 503 441 488 476 454C 512 421 566 408 567 373C 566 344 549 308 495 306C 463 303 445 314 411 361C 400 373 384 382 372 373C 372 373 318 333 318 333C 309 323 303 307 312 293C 362 218 401 191 501 191C 501 191 501 191 501 191M 500 625C 541 625 575 659 575 700C 576 742 540 776 500 775C 457 775 426 739 425 700C 425 659 459 625 500 625C 500 625 500 625 500 625"/></svg>
                        <div class="text-yellow-600 text-2x font-bold text-sm"><span class="text">Shows a history of temperature data</span></div>
                    </div>
                </div>

                <div class="container" style="height: 40vh; width: 40vw;">
                    <canvas id="tempChart"></canvas>
                </div>


                <div class="flex p-12 font-bold text-xl block uppercase tracking-wide">
                    <div class="p-2"> Current temperature: 16 </div>
                    <div class="p-2"> Outside temperature: -16 </div>
                </div>

            </div>
        </div>

            <div class="flex py-4 space-x-16">
                <div>
                    <label class="flex-row items-center">
                        <div class="box bg-white rounded shadow h-auto w-auto">
                            <div class="p-2">
                                <div class="quesMin">
                                    <svg style="fill: deepskyblue" width="24" height="24" viewBox="0 0 1000 1000" xmlns="http://www.w3.org/2000/svg"><path d="M 500 0C 224 0 0 224 0 500C 0 776 224 1000 500 1000C 776 1000 1000 776 1000 500C 1000 224 776 0 500 0C 500 0 500 0 500 0 M 501 191C 626 191 690 275 690 375C 690 475 639 483 595 513C 573 525 558 553 559 575C 559 591 554 602 541 601C 541 601 460 601 460 601C 446 601 436 581 436 570C 436 503 441 488 476 454C 512 421 566 408 567 373C 566 344 549 308 495 306C 463 303 445 314 411 361C 400 373 384 382 372 373C 372 373 318 333 318 333C 309 323 303 307 312 293C 362 218 401 191 501 191C 501 191 501 191 501 191M 500 625C 541 625 575 659 575 700C 576 742 540 776 500 775C 457 775 426 739 425 700C 425 659 459 625 500 625C 500 625 500 625 500 625"/></svg>
                                <div class="text-yellow-600 text-2x font-bold text-sm"><span class="text">Set the minimum temperature you would like your home to be</span></div>
                            </div>
                            </div>
                            <div class="p-8 font-bold text-lg text-black block uppercase tracking-wide">
                                Set Minimum Temperature:
                                <div class="flex justify-center place-content-center"><span id="minTemp"></span></div>
                                <div class="flex justify-center p-4">
                                    <input type="range" min="0" max="10" value="0" class="range range-lg" id="minTempSlider">
                                </div>
                            </div>
                        </div>
                    </label>
                </div>

                <div>
                    <label class="flex-row items-center">
                        <div class="box bg-white rounded shadow h-auto w-auto">
                            <div class="p-2">
                                <div class="quesTarget">
                                    <svg style="fill: deepskyblue" width="24" height="24" viewBox="0 0 1000 1000" xmlns="http://www.w3.org/2000/svg"><path d="M 500 0C 224 0 0 224 0 500C 0 776 224 1000 500 1000C 776 1000 1000 776 1000 500C 1000 224 776 0 500 0C 500 0 500 0 500 0 M 501 191C 626 191 690 275 690 375C 690 475 639 483 595 513C 573 525 558 553 559 575C 559 591 554 602 541 601C 541 601 460 601 460 601C 446 601 436 581 436 570C 436 503 441 488 476 454C 512 421 566 408 567 373C 566 344 549 308 495 306C 463 303 445 314 411 361C 400 373 384 382 372 373C 372 373 318 333 318 333C 309 323 303 307 312 293C 362 218 401 191 501 191C 501 191 501 191 501 191M 500 625C 541 625 575 659 575 700C 576 742 540 776 500 775C 457 775 426 739 425 700C 425 659 459 625 500 625C 500 625 500 625 500 625"/></svg>
                                    <div class="text-yellow-600 text-2x font-bold text-sm"><span class="text">Set your desirable temperature of your home</span></div>
                                </div>
                            </div>

                            <div class="p-8 font-bold text-lg text-black block uppercase tracking-wide">
                                Set Target Temperature:
                                    <div class="flex justify-center place-content-center"><span id="maxTemp"></span></div>
                                    <div class="flex justify-center p-4">
                                        <input type="range" max="24" value="0" class="range range-lg" id="maxTempSlider">
                                    </div>
                            </div>
                        </div>
                    </label>
                </div>

                <div class="box bg-white rounded shadow h-auto w-auto">
                    <div>
                        <div class="p-2">
                            <div class="quesdt">
                                <svg style="fill: deepskyblue" width="24" height="24" viewBox="0 0 1000 1000" xmlns="http://www.w3.org/2000/svg"><path d="M 500 0C 224 0 0 224 0 500C 0 776 224 1000 500 1000C 776 1000 1000 776 1000 500C 1000 224 776 0 500 0C 500 0 500 0 500 0 M 501 191C 626 191 690 275 690 375C 690 475 639 483 595 513C 573 525 558 553 559 575C 559 591 554 602 541 601C 541 601 460 601 460 601C 446 601 436 581 436 570C 436 503 441 488 476 454C 512 421 566 408 567 373C 566 344 549 308 495 306C 463 303 445 314 411 361C 400 373 384 382 372 373C 372 373 318 333 318 333C 309 323 303 307 312 293C 362 218 401 191 501 191C 501 191 501 191 501 191M 500 625C 541 625 575 659 575 700C 576 742 540 776 500 775C 457 775 426 739 425 700C 425 659 459 625 500 625C 500 625 500 625 500 625"/></svg>
                                <div class="text-yellow-600 text-2x font-bold text-sm"><span class="text">Set your future date and time of arrival. If you're coming now, simply check the box below!</span></div>
                            </div>
                        </div>

                        <div class = "toggleSW">
                            <div class = "checkboxLab">
                                <div class="px-4 relative">
                                <label for="toggle" class="flex items-center cursor-pointer">
                                    <div class="relative">
                                        <input type="checkbox" id = "toggle" class="sr-only">
                                        <div class="block bg-gray-600 w-14 h-8 rounded-full"></div>
                                        <div class="dot absolute left-1 top-1 bg-white w-6 h-6 rounded-full transition"></div>
                                    </div>
                                    <div class="flex px-4 text-xl font-bold uppercase tracking-wide">Mode:&nbsp<div class="text-blue-500"><p id="checkboxLab"></div></p></div>
                                </div>
                                </label>
                            </div>
                        </div>

                        <div id="manual" class="absolute px-5 py-3 font-bold text-lg text-black block uppercase tracking-wide">
                            <label for="TargetTime">Target date and time:</label>
                            <input type="datetime-local" class="flex rounded shadow border" id="TargetTime" name="TargetTime">
                        </div>

                        <div id="immediate" class="absolute px-5 py-3">
                            <label class="inline-flex items-center">
                                <input type="checkbox" id="notifications" class="form-checkbox h-6 w-6" value="0">
                                <span class="ml-3 text-gray-800 text-xl italic font-bold">I'm Coming Home!</span>
                            </label>
                        </div>
                    </div>
                </div>

            </div>
        <div>
            <button class="shadow bg-yellow-300 hover:bg-yellow-200 focus:shadow-outline focus:outline-none text-black font-bold py-2 px-4 rounded" id="submitInfo">
                Submit Changes
            </button>
        </div>
    </div>
</div>

</body>

<script>

    let tempC = document.getElementById('tempChart').getContext('2d');

    let myChart = new Chart(tempC, {
        type:'line',
        data: {
            labels:['1','2','3','4','5'],
            datasets:[{
                label:'TEMPERATURE',
                data:[120, 111, 65, 25, 50],
                backgroundColor: '#FBBF24',
                borderColor:'#FBBF24',
                borderWidth: 1
            }],

        },
        options: {
            scales: {
                y: {
                    beginAtZero: true
                }
            },
            plugins:
                {
                    legend: {
                        display: true,
                        labels: {
                            color: '#FBBF24',
                            font: {
                                weight: 'bold',
                                size: 20
                            }
                        },
                        title: {
                            display: true,
                            text: 'REALTIME TEMPERATURE DATA',
                            color: 'black',
                            font: {
                                weight: 'bold',
                                size: 20

                            }
                        }
                    }
                }

        }
    });

    var toggleBox = document.querySelector('input[id="toggle"]');
    document.getElementById("checkboxLab").innerHTML = "Immediate"
    document.querySelector('div[id="manual"]').style.visibility = 'hidden';
    document.querySelector('div[id="immediate"]').style.visibility = 'visible';


    toggleBox.addEventListener('change', (event) => {

        if(toggleBox.checked)
        {
            document.getElementById("checkboxLab").innerHTML = "Manual"
            document.querySelector('div[id="manual"]').style.visibility = 'visible';
            document.querySelector('div[id="immediate"]').style.visibility = 'hidden';
        }
        else
        {
            document.getElementById("checkboxLab").innerHTML = "Immediate"
            document.querySelector('div[id="manual"]').style.visibility = 'hidden';
            document.querySelector('div[id="immediate"]').style.visibility = 'visible';
        }
        event.preventDefault();
    })

    let slider1 = document.getElementById("minTempSlider");
    let output1 = document.getElementById("minTemp");

    output1.innerHTML = slider1.value;

    slider1.oninput = function() {
        output1.innerHTML = this.value;
    }

    let slider2 = document.getElementById("maxTempSlider");
    let output2 = document.getElementById("maxTemp");

    output2.innerHTML = slider2.value;

    slider2.oninput = function() {
        output2.innerHTML = this.value;
    }

    $(document).ready(function () {
        let goingHome

        $('#submitInfo').on('click', function () {
            if($('#notifications').is(':checked')) {
                goingHome = true
            } else {
                goingHome = false
            }

            let updInfo = {
                minTemp: slider1.value,
                reqTemp: slider2.value,
                arrivalTime: document.getElementById('TargetTime').value,
                goingHome: goingHome,
            }
            console.log(updInfo)

            $.ajax({
                type: 'PATCH',
                url: '/home',
                data: JSON.stringify(updInfo),
                processData: false,
                contentType: 'application/json',
            })
            window.alert("Data saved!")
        })
    })
</script>

</html>